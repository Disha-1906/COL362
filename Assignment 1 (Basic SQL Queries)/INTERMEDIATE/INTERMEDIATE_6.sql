select q.subject_id, q.gender, w.c1 as total_admissions, w.m2 as last_admission, w.m1 as first_admission, w.c2 as diagnosis_count from patients as q join (select a.subject_id, a.c1, a.m1, a.m2, p.c2  from (select admissions.subject_id, count(distinct admissions.hadm_id) as c1, min(admissions.admittime) as m1, max(admissions.admittime) as m2 from admissions group by admissions.subject_id)  as a join (select subject_id, count(icd_code) as c2 from diagnoses_icd where icd_code = '5723' group by subject_id) as p on a.subject_id = p.subject_id) as w on q.subject_id = w.subject_id order by c1 desc, c2 desc, m2 desc, m1 desc, gender desc, q.subject_id desc limit 1000